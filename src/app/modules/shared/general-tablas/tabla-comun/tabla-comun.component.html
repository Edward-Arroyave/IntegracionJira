<div class="margenItems">
    @if (titulo() !== '') {
        <h1 style="margin-top: 1em;">{{titulo()}}</h1>
    }
    <div class="grid-filtro">
        <div style="display: flex; gap: 1em;">
            @if(viewButton()){
                <button  class="btnPurple-01" type="button" (click)="emitCreate(true)">
                    {{ 'Crear' | translate}} 
                    <mat-icon>note_add</mat-icon>
                </button>
                @if(viewButton2()){
                    <button  title="Duplicar lote" class="btnPurple-01" style="min-width: 28px; border-color:var(--blue-03) ; background: var(--blue-03);border-radius: 50%; padding: 0;" 
                            type="button" (click)="emitonButton2()">
                        <mat-icon style="font-size: 18px;margin-top: 6px;">file_copy</mat-icon>
                    </button>
                }
            }
        </div>
    
        <mat-form-field>
            <mat-label>{{'Buscar' | translate}}</mat-label>
            <input matInput  (keyup)="applyFilter($event)" #input>
            <mat-icon matSuffix class="icon-search">search</mat-icon>
        </mat-form-field>
    </div>
    <div>
        <div style="overflow-x: auto;">
            <table mat-table [dataSource]="dataSource" matSort>
                @for (item of columnsHeader(); track $index) {

                    @if (item === 'Detalles') {
                        <ng-container [matColumnDef]="item">
                            <th mat-header-cell *matHeaderCellDef>
                                {{item | translate}} </th>
                            <td mat-cell *matCellDef="let row"> 
                                <a style="cursor: pointer; color: var(--blue-01); text-decoration: underline;" 
                                (click)="emitPermissions(row.item)">Ver detalles</a>
                            </td>
                        </ng-container>
                    }

                    @if ( !['Estado','Editar','Eliminar','Permisos','Precarga','Detalles','Descargar','Contrase침a' ].includes(item)) {
                        <ng-container [matColumnDef]="item">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ item | translate}} </th>
                            <td mat-cell *matCellDef="let row"> {{row[item]}}</td>
                        </ng-container>
                    }

                    @if (item === 'Precarga') {
                        <ng-container [matColumnDef]="item">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                                {{item | translate}} </th>
                            <td mat-cell *matCellDef="let row">
                                @if (row[item].Resulttype !== 'N' || !row[item].Active) {
                                    <div class="editarIcon" style="background: var(--gray-02);">
                                        <mat-icon style="margin-top: .1em; font-size: 21px;">loop</mat-icon>
                                    </div>
                                }@else{
                                    <div class="editarIcon" style="background: var(--purple-01);" (click)="emitPermissions(row.item)">
                                        <mat-icon style="margin-top: .1em; font-size: 21px;">loop</mat-icon>
                                    </div>
                                }
                            </td>
                        </ng-container>
                    }

                    @if (item === 'Estado') {
                        <ng-container [matColumnDef]="item">
                            <th mat-header-cell *matHeaderCellDef>{{item | translate}} </th>
                            <td mat-cell *matCellDef="let row"> 
                                <mat-slide-toggle [checked]="row[item] || row[item]" (change)="emitStatus(row.item,$event.checked)">
                                </mat-slide-toggle>
                            </td>
                        </ng-container>
                    }

                    @if (item === 'Permisos') {
                        <ng-container [matColumnDef]="item">
                            <th mat-header-cell *matHeaderCellDef>
                                {{item | translate}} </th>
                            <td mat-cell *matCellDef="let row"> 
                                <div class="editarIcon" style="background: var(--purple-01);" (click)="emitPermissions(row.item)">
                                    <!-- <mat-icon style="font-size: 21px;">lock_open</mat-icon> -->
                                     <mat-icon style="font-size: 21px;">collections_bookmark</mat-icon>
                                </div>
                            </td>
                        </ng-container>
                    }
    
                    @if (item === 'Editar') {
                        <ng-container [matColumnDef]="item">
                            <th mat-header-cell *matHeaderCellDef>
                                {{item | translate}} </th>
                            <td mat-cell *matCellDef="let row">
                                <div class="editarIcon" (click)="emitEdit(row.item)">
                                    <mat-icon style="font-size: 21px;">edit</mat-icon> 
                                </div>
                            </td>
                        </ng-container>
                    }

                    @if (['Contrase침a'].includes(item)) {
                        <ng-container [matColumnDef]="item">
                            <th mat-header-cell *matHeaderCellDef>
                                {{item | translate}} </th>
                            <td mat-cell *matCellDef="let row">
                                <div class="editarIcon" style="background: var(--purple-01);" (click)="emitEditPass(row.item)">
                                    <mat-icon style="font-size: 21px;">lock_open</mat-icon>
                                </div>
                            </td>
                        </ng-container>
                    }
    
                    @if (item === 'Eliminar') {
                        <ng-container [matColumnDef]="item">
                            <th mat-header-cell *matHeaderCellDef>
                                {{item | translate}} </th>
                            <td mat-cell *matCellDef="let row">
                                <div class="eliminarIcon" (click)="emitDelete(row.item)">
                                    <mat-icon>close</mat-icon>
                                </div>
                            </td>
                        </ng-container>
                    }

                    @if (item === 'Descargar') {
                        <ng-container [matColumnDef]="item">
                            <th mat-header-cell *matHeaderCellDef mat-sort-header>
                                {{item | translate}} </th>
                            <td mat-cell *matCellDef="let row">
                                <div class="editarIcon" (click)="emitDownload(row)">
                                    <mat-icon>vertical_align_bottom</mat-icon>
                                </div>
                            </td>
                        </ng-container>
                    }
                }
        
                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        
                <tr class="mat-row" *matNoDataRow>
                    <td class="mat-cell" colspan="4">No se encontr칩 informaci칩n con el filtro "{{input.value}}"</td>
                </tr>
            </table>
        </div>
        <mat-paginator  [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
    </div>
</div>




